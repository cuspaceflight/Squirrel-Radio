package uk.ac.cam.cusf.squirrelradio;

import android.util.Base64;

public class Encryptor {

    // 1024 char key is defined in static initialiser
    private static char[] KEY;
    private int i = 0;

    private char keyChar() {
        return KEY[i++ % (KEY.length - 1)];
    }

    public void setKeyPosition(int seed) {
        i = seed % (KEY.length - 1);
    }

    public void setKeyPosition(long seed) {
        setKeyPosition((int) (seed % Integer.MAX_VALUE));
    }

    public int keyPosition() {
        return i;
    }

    public String encrypt(String text) {

        StringBuilder sb = new StringBuilder();
        for (char c : text.toCharArray()) {
            sb.append((char) (c ^ keyChar()));
        }

        return Base64.encodeToString(sb.toString().getBytes(), Base64.DEFAULT
                | Base64.NO_PADDING | Base64.NO_WRAP);
    }

    static {
        KEY = new char[] { 81, 62, 117, 102, 245, 117, 63, 169, 175, 224, 176,
                174, 242, 127, 29, 61, 81, 98, 215, 118, 165, 56, 138, 171, 18,
                152, 78, 112, 241, 167, 164, 167, 128, 212, 212, 105, 103, 9,
                74, 160, 129, 146, 91, 203, 188, 245, 79, 143, 83, 60, 91, 168,
                74, 147, 246, 168, 247, 218, 69, 19, 98, 120, 254, 232, 178,
                64, 152, 249, 26, 254, 38, 132, 90, 143, 187, 198, 112, 39,
                206, 33, 127, 132, 74, 31, 197, 24, 104, 204, 218, 203, 136, 6,
                86, 66, 117, 172, 226, 173, 132, 216, 48, 78, 251, 57, 5, 185,
                1, 109, 41, 12, 21, 93, 210, 130, 72, 12, 99, 84, 170, 252, 8,
                249, 125, 87, 94, 192, 80, 20, 95, 130, 100, 63, 171, 115, 169,
                42, 6, 133, 126, 149, 115, 195, 183, 167, 202, 64, 64, 191,
                108, 194, 175, 168, 202, 92, 201, 191, 193, 238, 80, 162, 72,
                132, 225, 2, 148, 137, 59, 79, 61, 136, 115, 250, 1, 218, 233,
                119, 45, 232, 32, 21, 63, 5, 25, 255, 196, 111, 146, 166, 28,
                75, 72, 209, 170, 36, 201, 36, 112, 51, 237, 52, 96, 29, 68,
                14, 127, 114, 192, 83, 85, 122, 187, 17, 18, 255, 56, 104, 195,
                111, 97, 200, 151, 183, 117, 204, 181, 146, 107, 139, 54, 41,
                118, 85, 92, 49, 51, 142, 111, 98, 223, 11, 226, 154, 211, 91,
                145, 179, 96, 84, 15, 211, 216, 48, 21, 14, 183, 157, 74, 60,
                18, 227, 228, 184, 142, 103, 201, 130, 238, 184, 137, 113, 5,
                28, 121, 98, 236, 234, 30, 179, 254, 56, 125, 247, 132, 43, 8,
                39, 151, 227, 124, 184, 217, 50, 95, 111, 106, 16, 90, 57, 95,
                174, 5, 190, 83, 81, 211, 149, 35, 155, 156, 80, 134, 22, 210,
                211, 51, 230, 118, 167, 218, 135, 53, 108, 46, 238, 80, 85, 96,
                186, 53, 195, 8, 81, 95, 191, 66, 190, 192, 37, 225, 106, 174,
                229, 50, 129, 242, 240, 114, 235, 100, 23, 14, 47, 99, 73, 33,
                19, 176, 88, 255, 78, 218, 222, 22, 110, 182, 68, 54, 12, 154,
                103, 139, 61, 175, 97, 239, 184, 52, 92, 10, 181, 194, 94, 102,
                237, 128, 234, 230, 66, 86, 81, 149, 201, 126, 59, 0, 45, 23,
                23, 62, 143, 202, 172, 84, 13, 12, 18, 57, 18, 195, 90, 181,
                114, 10, 178, 121, 166, 174, 194, 16, 3, 234, 150, 55, 41, 234,
                8, 31, 13, 102, 234, 113, 210, 46, 115, 238, 137, 149, 70, 166,
                65, 31, 220, 87, 8, 80, 215, 62, 189, 57, 207, 46, 165, 44,
                112, 90, 96, 220, 166, 36, 28, 138, 88, 210, 38, 235, 230, 168,
                212, 171, 114, 92, 95, 72, 149, 17, 103, 39, 90, 221, 189, 95,
                76, 51, 157, 111, 213, 174, 211, 115, 87, 236, 142, 40, 243,
                57, 119, 75, 220, 15, 175, 247, 194, 10, 215, 132, 99, 16, 16,
                10, 139, 138, 129, 195, 204, 172, 185, 12, 89, 27, 222, 186,
                52, 13, 158, 157, 167, 130, 58, 224, 86, 209, 194, 116, 16,
                180, 120, 95, 28, 105, 95, 149, 162, 88, 64, 238, 212, 3, 247,
                122, 253, 172, 115, 5, 168, 56, 13, 104, 217, 159, 12, 151,
                137, 73, 87, 184, 201, 34, 130, 233, 166, 81, 170, 159, 249,
                236, 93, 97, 171, 65, 24, 221, 80, 218, 132, 81, 234, 93, 54,
                145, 63, 21, 135, 66, 202, 7, 4, 99, 0, 255, 37, 84, 62, 93,
                182, 238, 4, 9, 251, 76, 255, 26, 33, 213, 253, 195, 135, 113,
                247, 128, 238, 196, 240, 201, 218, 35, 129, 112, 159, 188, 41,
                83, 159, 198, 232, 192, 126, 125, 167, 25, 149, 93, 239, 155,
                189, 32, 157, 84, 31, 10, 233, 112, 23, 225, 165, 132, 6, 167,
                133, 202, 65, 124, 145, 88, 76, 171, 147, 37, 71, 24, 17, 58,
                159, 250, 110, 187, 94, 42, 234, 35, 228, 27, 27, 94, 7, 17,
                243, 8, 86, 179, 34, 186, 82, 69, 123, 216, 38, 219, 68, 91,
                26, 229, 89, 102, 234, 162, 162, 163, 203, 130, 121, 101, 190,
                117, 144, 49, 127, 21, 152, 212, 198, 104, 222, 108, 121, 39,
                85, 9, 21, 165, 27, 245, 207, 65, 226, 71, 216, 83, 185, 128,
                171, 76, 93, 20, 110, 239, 24, 223, 202, 225, 83, 0, 184, 71,
                155, 54, 190, 57, 120, 156, 114, 185, 105, 148, 119, 245, 224,
                66, 158, 164, 216, 129, 149, 175, 253, 123, 216, 24, 205, 156,
                21, 10, 145, 199, 242, 142, 70, 92, 180, 149, 46, 78, 205, 177,
                221, 177, 168, 210, 129, 210, 69, 201, 129, 142, 219, 185, 136,
                118, 146, 133, 210, 130, 120, 211, 57, 65, 53, 146, 235, 102,
                139, 58, 200, 133, 76, 21, 193, 205, 151, 217, 158, 115, 187,
                235, 227, 138, 232, 109, 229, 135, 155, 191, 146, 236, 79, 236,
                166, 8, 1, 192, 183, 72, 53, 228, 248, 226, 158, 198, 103, 210,
                54, 65, 163, 50, 216, 28, 1, 247, 34, 211, 129, 100, 32, 167,
                31, 106, 157, 25, 83, 115, 181, 66, 42, 145, 68, 245, 103, 20,
                44, 168, 114, 85, 65, 66, 247, 70, 232, 64, 179, 197, 41, 226,
                185, 174, 202, 6, 186, 151, 37, 40, 130, 20, 32, 96, 192, 25,
                137, 62, 70, 192, 146, 255, 194, 50, 131, 144, 69, 73, 163,
                193, 120, 100, 27, 123, 233, 229, 65, 45, 95, 66, 129, 188,
                112, 226, 255, 97, 227, 159, 135, 47, 160, 151, 67, 128, 201,
                69, 33, 79, 234, 26, 24, 73, 147, 112, 160, 185, 76, 119, 208,
                224, 103, 237, 180, 108, 113, 170, 151, 224, 10, 35, 103, 0,
                218, 54, 18, 16, 91, 209, 223, 135, 68, 135, 202, 163, 9, 165,
                122, 20, 215, 39, 117, 250, 163, 48, 61, 216, 56, 229, 167,
                236, 76, 44, 73, 51, 42, 20, 185, 197, 43, 156, 24, 132, 242,
                7, 219 };
    }

}
